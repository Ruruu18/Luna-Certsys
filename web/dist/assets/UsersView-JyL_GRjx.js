import{d as N,r as u,h as B,c as a,a as e,b as c,f as k,m as _,t as r,F as S,x as F,w as C,e as p,v as y,y as L,n as $,o as d}from"./index-_QPn6ggU.js";import{u as H}from"./users-CyS2RdYu.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";const j={class:"users-view"},z={class:"view-header"},T={class:"header-right"},q={class:"table-container"},R={key:0,class:"loading"},G={key:1,class:"alert alert-error"},I={key:2,class:"empty-state"},J={key:3,class:"table"},K={class:"user-cell"},O={class:"user-avatar"},Q={class:"user-name"},W={class:"action-buttons"},X=["onClick"],Y=["onClick","disabled"],Z={class:"modal-header"},ee={class:"modal-title"},le={class:"modal-body"},se={key:0,class:"alert alert-error"},te={class:"form-group"},oe=["disabled"],ne={class:"form-group"},ae=["disabled"],re={class:"form-group"},de=["disabled"],ie={class:"form-group"},ue=["disabled"],ve={class:"form-group"},me=["disabled"],pe={class:"form-group"},be=["disabled"],fe={class:"modal-footer"},ce=["disabled"],ke=["disabled"],_e={key:0,class:"spinner"},ye={class:"modal-body"},ge={class:"modal-footer"},he=["disabled"],we=["disabled"],Ce={key:0,class:"spinner"},Ue=N({__name:"UsersView",setup(xe){const i=H(),g=u(!1),v=u(!1),b=u(!1),o=u(!1),m=u(""),f=u(null),h=u(null),n=u({full_name:"",email:"",role:"resident",purok:"",phone_number:"",address:""}),x=()=>{n.value={full_name:"",email:"",role:"resident",purok:"",phone_number:"",address:""},m.value=""},w=()=>{g.value=!1,v.value=!1,h.value=null,x()},M=t=>{h.value=t,n.value={full_name:t.full_name,email:t.email,role:t.role,purok:t.purok||"",phone_number:t.phone_number||"",address:t.address||""},v.value=!0},D=t=>{f.value=t,b.value=!0},U=async()=>{o.value=!0,m.value="";try{if(v.value&&h.value){const{success:t,error:l}=await i.updateUser(h.value.id,n.value);if(!t){m.value=l||"Failed to update user";return}}else{const{success:t,error:l}=await i.addUser(n.value);if(!t){m.value=l||"Failed to create user";return}}w()}catch(t){m.value="An unexpected error occurred",console.error("Error submitting form:",t)}finally{o.value=!1}},V=async()=>{if(f.value){o.value=!0;try{const{success:t}=await i.removeUser(f.value.id);t&&(b.value=!1,f.value=null)}catch(t){console.error("Error deleting user:",t)}finally{o.value=!1}}},A=t=>new Date(t).toLocaleDateString();return B(()=>{i.fetchUsers()}),(t,l)=>(d(),a("div",j,[e("div",z,[l[13]||(l[13]=e("div",{class:"header-left"},[e("h2",{class:"view-title"},"User Management"),e("p",{class:"view-description"},"Manage system users and their roles")],-1)),e("div",T,[e("button",{onClick:l[0]||(l[0]=s=>g.value=!0),class:"btn btn-primary"},[...l[12]||(l[12]=[e("svg",{class:"btn-icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),k(" Add User ",-1)])])])]),e("div",q,[_(i).loading?(d(),a("div",R,[...l[14]||(l[14]=[e("div",{class:"spinner"},null,-1),e("p",null,"Loading users...",-1)])])):_(i).error?(d(),a("div",G,r(_(i).error),1)):_(i).users.length===0?(d(),a("div",I,[l[15]||(l[15]=e("svg",{class:"empty-icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})],-1)),l[16]||(l[16]=e("h3",null,"No users found",-1)),l[17]||(l[17]=e("p",null,"Get started by adding your first user",-1)),e("button",{onClick:l[1]||(l[1]=s=>g.value=!0),class:"btn btn-primary"},"Add User")])):(d(),a("table",J,[l[20]||(l[20]=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Email"),e("th",null,"Role"),e("th",null,"Purok"),e("th",null,"Phone"),e("th",null,"Created"),e("th",null,"Actions")])],-1)),e("tbody",null,[(d(!0),a(S,null,F(_(i).users,s=>(d(),a("tr",{key:s.id},[e("td",null,[e("div",K,[e("div",O,r(s.full_name.charAt(0).toUpperCase()),1),e("div",null,[e("div",Q,r(s.full_name),1)])])]),e("td",null,r(s.email),1),e("td",null,[e("span",{class:$(["badge",{"badge-danger":s.role==="admin","badge-warning":s.role==="purok_chairman","badge-info":s.role==="resident"}])},r(s.role.replace("_"," ")),3)]),e("td",null,r(s.purok||"-"),1),e("td",null,r(s.phone_number||"-"),1),e("td",null,r(A(s.created_at)),1),e("td",null,[e("div",W,[e("button",{onClick:E=>M(s),class:"btn btn-outline btn-sm",title:"Edit user"},[...l[18]||(l[18]=[e("svg",{class:"btn-icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,X),e("button",{onClick:E=>D(s),class:"btn btn-danger btn-sm",title:"Delete user",disabled:s.role==="admin"},[...l[19]||(l[19]=[e("svg",{class:"btn-icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,Y)])])]))),128))])]))]),g.value||v.value?(d(),a("div",{key:0,class:"modal",onClick:w},[e("div",{class:"modal-content",onClick:l[8]||(l[8]=C(()=>{},["stop"]))},[e("div",Z,[e("h3",ee,r(v.value?"Edit User":"Add New User"),1)]),e("div",le,[e("form",{onSubmit:C(U,["prevent"])},[m.value?(d(),a("div",se,r(m.value),1)):c("",!0),e("div",te,[l[21]||(l[21]=e("label",{for:"full_name",class:"form-label"},"Full Name",-1)),p(e("input",{id:"full_name","onUpdate:modelValue":l[2]||(l[2]=s=>n.value.full_name=s),type:"text",class:"form-input",required:"",disabled:o.value},null,8,oe),[[y,n.value.full_name]])]),e("div",ne,[l[22]||(l[22]=e("label",{for:"email",class:"form-label"},"Email",-1)),p(e("input",{id:"email","onUpdate:modelValue":l[3]||(l[3]=s=>n.value.email=s),type:"email",class:"form-input",required:"",disabled:o.value||v.value},null,8,ae),[[y,n.value.email]])]),e("div",re,[l[24]||(l[24]=e("label",{for:"role",class:"form-label"},"Role",-1)),p(e("select",{id:"role","onUpdate:modelValue":l[4]||(l[4]=s=>n.value.role=s),class:"form-select",required:"",disabled:o.value},[...l[23]||(l[23]=[e("option",{value:"resident"},"Resident",-1),e("option",{value:"purok_chairman"},"Purok Chairman",-1),e("option",{value:"admin"},"Admin",-1)])],8,de),[[L,n.value.role]])]),e("div",ie,[l[25]||(l[25]=e("label",{for:"purok",class:"form-label"},"Purok",-1)),p(e("input",{id:"purok","onUpdate:modelValue":l[5]||(l[5]=s=>n.value.purok=s),type:"text",class:"form-input",placeholder:"e.g., 1, 2, 3...",disabled:o.value},null,8,ue),[[y,n.value.purok]])]),e("div",ve,[l[26]||(l[26]=e("label",{for:"phone_number",class:"form-label"},"Phone Number",-1)),p(e("input",{id:"phone_number","onUpdate:modelValue":l[6]||(l[6]=s=>n.value.phone_number=s),type:"tel",class:"form-input",disabled:o.value},null,8,me),[[y,n.value.phone_number]])]),e("div",pe,[l[27]||(l[27]=e("label",{for:"address",class:"form-label"},"Address",-1)),p(e("textarea",{id:"address","onUpdate:modelValue":l[7]||(l[7]=s=>n.value.address=s),class:"form-input",rows:"3",disabled:o.value},null,8,be),[[y,n.value.address]])])],32)]),e("div",fe,[e("button",{onClick:w,type:"button",class:"btn btn-outline",disabled:o.value}," Cancel ",8,ce),e("button",{onClick:U,type:"submit",class:"btn btn-primary",disabled:o.value},[o.value?(d(),a("div",_e)):c("",!0),k(" "+r(v.value?"Update":"Create")+" User ",1)],8,ke)])])])):c("",!0),b.value?(d(),a("div",{key:1,class:"modal",onClick:l[11]||(l[11]=s=>b.value=!1)},[e("div",{class:"modal-content",onClick:l[10]||(l[10]=C(()=>{},["stop"]))},[l[32]||(l[32]=e("div",{class:"modal-header"},[e("h3",{class:"modal-title"},"Confirm Deletion")],-1)),e("div",ye,[e("p",null,[l[28]||(l[28]=k("Are you sure you want to delete ",-1)),e("strong",null,r(f.value?.full_name),1),l[29]||(l[29]=k("?",-1))]),l[30]||(l[30]=e("p",{class:"text-sm text-gray-600"},"This action cannot be undone.",-1))]),e("div",ge,[e("button",{onClick:l[9]||(l[9]=s=>b.value=!1),type:"button",class:"btn btn-outline",disabled:o.value}," Cancel ",8,he),e("button",{onClick:V,type:"button",class:"btn btn-danger",disabled:o.value},[o.value?(d(),a("div",Ce)):c("",!0),l[31]||(l[31]=k(" Delete User ",-1))],8,we)])])])):c("",!0)]))}}),Ae=P(Ue,[["__scopeId","data-v-8a4f03e5"]]);export{Ae as default};
