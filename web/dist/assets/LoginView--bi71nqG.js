import{d as b,u as y,r as d,c as u,a as s,w,b as m,t as g,e as p,v as f,f as h,g as A,o as c}from"./index-_QPn6ggU.js";import{_ as x}from"./logo-C4pLZIDc.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";const S={class:"login-container"},V={class:"login-card"},C={key:0,class:"alert alert-error"},k={class:"form-group"},E=["disabled"],I={class:"form-group"},P=["disabled"],q=["disabled"],B={key:0,class:"spinner"},N=b({__name:"LoginView",setup(T){const v=A(),o=y(),i=d(""),n=d(""),l=d(!1),a=d(""),_=async()=>{if(!i.value||!n.value){a.value="Please fill in all fields";return}l.value=!0,a.value="";try{console.log("Attempting login for:",i.value);const{data:t,error:e}=await o.signIn(i.value,n.value);e?(console.error("Login error:",e),a.value=e.message||"Invalid credentials"):t?.user?(console.log("Login successful, waiting for profile to load..."),await new Promise(r=>setTimeout(r,2e3)),console.log("Auth store state after login:",{user:o.user,isAuthenticated:o.isAuthenticated,isAdmin:o.isAdmin}),o.user&&o.user.role==="admin"?(console.log("Admin login successful, redirecting..."),v.push({name:"admin-dashboard"})):o.user&&o.user.role!=="admin"?(a.value="Admin access required. Your role: "+o.user.role,await o.signOut()):(a.value="Failed to load user profile. Please try again.",await o.signOut())):a.value="Login failed - no user data received"}catch(t){console.error("Login exception:",t),a.value="An unexpected error occurred: "+(t.message||t)}finally{l.value=!1}};return(t,e)=>(c(),u("div",S,[s("div",V,[e[4]||(e[4]=s("div",{class:"login-header"},[s("img",{src:x,alt:"Luna Certsys",class:"login-logo"}),s("h1",{class:"login-title"},"Luna Certsys"),s("p",{class:"login-subtitle"},"Sign in to access the admin panel")],-1)),s("form",{onSubmit:w(_,["prevent"]),class:"login-form"},[a.value?(c(),u("div",C,g(a.value),1)):m("",!0),s("div",k,[e[2]||(e[2]=s("label",{for:"email",class:"form-label"},"Email",-1)),p(s("input",{id:"email","onUpdate:modelValue":e[0]||(e[0]=r=>i.value=r),type:"email",class:"form-input",placeholder:"admin@example.com",required:"",disabled:l.value},null,8,E),[[f,i.value]])]),s("div",I,[e[3]||(e[3]=s("label",{for:"password",class:"form-label"},"Password",-1)),p(s("input",{id:"password","onUpdate:modelValue":e[1]||(e[1]=r=>n.value=r),type:"password",class:"form-input",placeholder:"Enter your password",required:"",disabled:l.value},null,8,P),[[f,n.value]])]),s("button",{type:"submit",class:"btn btn-primary login-button",disabled:l.value},[l.value?(c(),u("div",B)):m("",!0),h(" "+g(l.value?"Signing in...":"Sign In"),1)],8,q)],32),e[5]||(e[5]=s("div",{class:"login-footer"},[s("p",{class:"text-sm text-gray-600"}," Admin access only. Contact your system administrator if you need access. ")],-1))])]))}}),U=L(N,[["__scopeId","data-v-23f067e0"]]);export{U as default};
